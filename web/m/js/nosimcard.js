define(["knockout","service","jquery","configPath"],function(e,i,o,r){function n(){showLoading(),d=O.LOADING;var e=_.val();i.enterPIN({PinNumber:e},function(e){e.result||(hideLoading(),a(),b.show(),_.val("")),a(),d==O.WAIT_PUK&&hideLoading()})}function t(){showLoading(),d=O.LOADING;var e={};e.PinNumber=f.val(),e.PUKNumber=l.val(),i.enterPUK(e,function(e){e.result?(a(),d==O.PUK_LOCKED&&hideLoading()):(hideLoading(),a(),A.show(),l.val(""),f.val(""),p.val(""))})}function a(){var e=i.getLoginData(),o=s(e);o==O.LOADING?addTimeout(a,500):c(o,e.pinnumber,e.puknumber)}function c(e,i,o){d=e,m.text(i),v.text(o),h.hide(),g.hide(),w.hide(),P.hide(),y.hide(),k.hide(),I.hide(),N.hide(),L.hide(),U.hide(),e==O.NO_SIM?h.show():e==O.WAIT_PIN?(g.show(),L.show(),U.show(),i>1?y.show():k.show()):e==O.WAIT_PUK?(w.show(),L.show(),U.show(),o>1?I.show():N.show()):e==O.PUK_LOCKED&&P.show()}function s(e){var n=e.modem_main_state;if("modem_sim_undetected"==n||"modem_undetected"==n||"modem_sim_destroy"==n)return O.NO_SIM;if(-1!=o.inArray(n,r.TEMPORARY_MODEM_MAIN_STATE))return O.LOADING;if("modem_waitpin"==n)return O.WAIT_PIN;if(("modem_waitpuk"==n||0==e.pinnumber)&&0!=e.puknumber)return O.WAIT_PUK;if((0==e.puknumber||"modem_sim_destroy"==n)&&"modem_sim_undetected"!=n&&"modem_undetected"!=n)return O.PUK_LOCKED;var t=window.location.href;if("#/nosimcard"==window.location.hash){hideLoading();"0"==i.getParams({nv:["privacy_read_flag"]}).privacy_read_flag&&r.HAS_GDPR||(-1!=window.location.href.indexOf("?traffic_view")?window.location.href=t.slice(0,t.indexOf("?traffic_view"))+"#/traffic/view":-1!=window.location.href.indexOf("?traffic_setting")?window.location.href=t.slice(0,t.indexOf("?traffic_setting"))+"#/traffic/traffic_setting":-1!=window.location.href.indexOf("?ota_update")?window.location.href=t.slice(0,t.indexOf("?ota_update"))+"#/others/ota_update":window.location.hash="#/home")}else window.location.reload()}function u(){_=o("#txtPIN"),l=o("#txtPUK"),f=o("#txtNewPIN"),p=o("#txtConfirmPIN"),m=o("#pinNumber"),v=o("#pukNumber"),h=o("#divNoSim"),g=o("#frmPIN"),w=o("#frmPUK"),P=o("#divPukLock"),y=o("#morePin"),k=o("#lastPin"),I=o("#morePuk"),N=o("#lastPuk"),b=o("#pinError"),A=o("#pukError"),L=o("#divLogo"),U=o("#copyright");var e=i.getLoginData(),u=s(e);c(u,e.pinnumber,e.puknumber),u==O.LOADING&&addTimeout(a,500),o("#btnPinApply").off("click").on("click",function(){g.submit()}),o("#btnPUKApply").off("click").on("click",function(){w.submit()}),g.validate({submitHandler:function(){n()},rules:{txtPIN:"pin_check"}}),w.validate({submitHandler:function(){t()},rules:{txtNewPIN:"pin_check",txtConfirmPIN:{equalToPin:"#txtNewPIN"},txtPUK:"puk_check"}}),o("#rejectBtn").off("click").on("click",function(){i.logout({},function(){window.location.reload()})}),o("#finishBtn").off("click").on("click",function(){var e={privacy_read_flag:"1"};i.setHaveReadPrivacyNote(e,function(e){if(e&&"success"==e.result)if(o("#privacy_policy").addClass("hide"),o("#privacy_policy").popup("close"),r.HAS_USER_IMPROVEMENT)o("#user_improv").removeClass("hide"),o("#user_improv").popup("open");else{var n=i.getLoginData(),t=s(n);c(t,n.pinnumber,n.puknumber)}})}),o("#isAllowedUserImprov").off("click").on("click",function(){o('label[for="isAllowedUserImprov"]').hasClass("ui-checkbox-on")?(o("#isAllowedUserImprov").attr("checked",!1),o('label[for="isAllowedUserImprov"]').addClass("ui-checkbox-off")):(o("#isAllowedUserImprov").attr("checked",!0),o('label[for="isAllowedUserImprov"]').addClass("ui-checkbox-on"))}),o("#confirmBtn").off("click").on("click",function(){var e={tr069_user_improv_flag:o('label[for="isAllowedUserImprov"]').hasClass("ui-checkbox-on")?"1":"0"};i.setUserImprovNote(e,function(e){e&&"success"==e.result&&(o("#user_improv").addClass("hide"),o("#user_improv").popup("close"),o("#user_grant").removeClass("hide"),o("#user_grant").popup("open"))})}),o("#userGrantRejectBtn").off("click").on("click",function(){var e={dm_user_grant_flag:"0"};i.setUserGrantNote(e,function(e){if("1"==i.getParams({nv:["dm_user_grant_notify_flag"]}).dm_user_grant_notify_flag){o("#user_grant").addClass("hide"),o("#user_grant").popup("close");var r=i.getLoginData();c(s(r),r.pinnumber,r.puknumber)}})}),o("#userGrantAcceptBtn").off("click").on("click",function(){var e={dm_user_grant_flag:"1"};i.setUserGrantNote(e,function(e){if("1"==i.getParams({nv:["dm_user_grant_notify_flag"]}).dm_user_grant_notify_flag){o("#user_grant").addClass("hide"),o("#user_grant").popup("close");var r=i.getLoginData();c(s(r),r.pinnumber,r.puknumber)}})}),r.HAS_GDPR?(o("#privacy_span").show(),o("#privacy_a").show()):(o("#privacy_span").hide(),o("#privacy_a").hide()),setTimeout(function(){var e=i.getParams({nv:["privacy_read_flag","tr069_user_improv_notify_flag","dm_user_grant_notify_flag"]});"0"==e.privacy_read_flag&&r.HAS_GDPR?(o("#privacy_policy").removeClass("hide"),o("#privacy_policy").popup("open")):"0"==e.tr069_user_improv_notify_flag?(o("#user_improv").removeClass("hide"),o("#user_improv").popup("open")):"0"==e.dm_user_grant_notify_flag&&(o("#user_grant").removeClass("hide"),o("#user_grant").popup("open"))},1e3),"zh-cn"==i.getLanguage().Language?o("#privacy_a").attr("href","https://www.ztedevices.com/cn/Privacy-Policy/ZTESmartRouterPrivacyPolicy"):o("#privacy_a").attr("href","https://www.ztedevices.com/en/Privacy-Policy/ZTESmartRouterPrivacyPolicy")}var d,_,l,f,p,m,v,h,g,w,P,y,k,I,N,b,A,L,U,O={NO_SIM:0,WAIT_PIN:1,WAIT_PUK:2,PUK_LOCKED:3,LOADING:4};return{init:u}});
//# sourceMappingURL=../../sourcemaps/m/nosimcard.js.map
