define(["jquery","knockout","configPath","service","underscore"],function(s,e,t,i,o){function a(s){for(var e=[],t=1;t<=s;t++)e.push(new Option(t,t));return e}function n(){function o(s){var e=(new Date).getTime();return s.QrImageUrl?s.QrImageUrl+"?_="+e:""}var n=this,r=i.getWifiModuleSwitchStatus(),S=i.getWifiAccessPointInfo(),u=wifiFilterAPInfo(r,S,t.WIFICHIPINDEX.FIRST,t.ACCESSPOINTINDEX.SECOND,t.WIFICHIPINDEX,t.ACCESSPOINTINDEX);n.hasWifiSwitch=t.WIFI_SWITCH_SUPPORT,n.hasGuestSSIDControl=t.WIFI_GUEST_SSID_ACCESS_SUPPORT,n.hasQRImg=t.WIFI_SUPPORT_QR_CODE,n.hasWifiMacFilter=t.WIFI_MAC_FILTER_SUPPORT,n.hasMultiSSID=t.HAS_MULTI_SSID,n.hasWifiDoubleChip=t.WIFI_DOUBLE_CHIP,n.showIsolated=t.SHOW_WIFI_AP_ISOLATED,n.wifi_enable=e.observable(u.wifiSwitch),n.accessPoint24gEnable=e.observable(u.AccessPointSwitchStatus),n.originAccessPoint24gEnable=e.observable(u.AccessPointSwitchStatus),n.isShowSSIDInfoDiv=e.observable(!1);var m=i.getParams({nv:"lan_sec_ssid_control"}).lan_sec_ssid_control;n.lan_sec_ssid_control=e.observable(m),t.WIFI_SWITCH_SUPPORT?"0"!=u.wifiSwitch?n.isShowSSIDInfoDiv(!0):n.isShowSSIDInfoDiv(!1):n.isShowSSIDInfoDiv(!0);var w="OPEN"==u.AuthMode;n.securityModeChangeHandler=function(){w&&(n.m_passPhrase(""),clearValidateMsg("#passwordContainer")),w="OPEN"==n.m_selectedMode()};var f="OPEN"==u.AuthMode_5g;n.securityModeChangeHandler_5g=function(){f&&(n.m_passPhrase_5g(""),clearValidateMsg("#passwordContainer")),f="OPEN"==n.m_selectedMode_5g()},n.maxStationNumber=e.computed(function(){return t.MAX_STATION_NUMBER}),n.m_modes=e.observableArray(h),n.m_selectedMode=e.observable(u.AuthMode),n.m_passPhrase=e.observable(u.Password),n.m_showPassword=e.observable(!1),n.m_ssid=e.observable(u.SSID),n.m_broadcast=e.observable("1"==u.ApBroadcastDisabled?"1":"0"),n.m_apIsolation=e.observable("1"==u.ApIsolate?"1":"0"),n.m_cipher=u.cipher,n.m_selectedStation=e.observable(u.ApMaxStationNumber),n.m_maxStations=e.observableArray(a(t.MAX_STATION_NUMBER)),n.m_showQrCode=e.observable(!("0"==u.QrImageShow)),n.m_qrcode_ssid1=e.observable(o(u)),n.m_showQrCodeHandler=function(){s("#m_showQrCode").parent().find(".error").hide();var e=s("#m_showQrCode:checked");e&&0==e.length?n.m_showQrCode(!0):n.m_showQrCode(!1)};var I=wifiFilterAPInfo(r,S,t.WIFICHIPINDEX.SECOND,t.ACCESSPOINTINDEX.SECOND,t.WIFICHIPINDEX,t.ACCESSPOINTINDEX);n.m_showQrCode_5g=e.observable(!("0"==I.QrImageShow)),n.m_qrcode_ssid1_5g=e.observable(o(I)),n.m_showQrCodeHandler_5g=function(){s("#m_showQrCode_5g").parent().find(".error").hide();var e=s("#m_showQrCode_5g:checked");e&&0==e.length?n.m_showQrCode_5g(!0):n.m_showQrCode_5g(!1)},n.accessPoint50gEnable=e.observable(I.AccessPointSwitchStatus),n.originAccessPoint50gEnable=e.observable(I.AccessPointSwitchStatus),n.m_modes_5g=e.observableArray(h),n.m_selectedMode_5g=e.observable(I.AuthMode),n.m_passPhrase_5g=e.observable(I.Password),n.m_showPassword_5g=e.observable(!1),n.m_ssid_5g=e.observable(I.SSID),n.m_broadcast_5g=e.observable("1"==I.ApBroadcastDisabled?"1":"0"),n.m_apIsolation_5g=e.observable("1"==I.ApIsolate?"1":"0"),n.m_cipher_5g=I.cipher,n.m_selectedStation_5g=e.observable(I.ApMaxStationNumber),n.m_maxStations_5g=e.observableArray(a(t.MAX_STATION_NUMBER)),n.clear=function(s){"switch"==s?(n.multi_ssid_enable(u.multi_ssid_enable),n.wifi_enable(u.wifiSwitch)):"ssid1"==s?(n.selectedMode(u.AuthMode),n.passPhrase(u.Password),n.ssid(u.SSID),n.broadcast("1"==u.ApBroadcastDisabled?"1":"0"),n.cipher=u.cipher,n.selectedStation(u.ApMaxStationNumber),n.apIsolation("1"==u.ApIsolate?"1":"0")):"ssid2"==s?(n.m_selectedMode(u.m_AuthMode),n.m_passPhrase(u.m_passPhrase),n.m_ssid(u.m_SSID),n.m_broadcast("1"==u.m_broadcast?"1":"0"),n.m_cipher=u.m_cipher,n.m_selectedStation(u.m_MAX_Access_num),n.m_apIsolation("1"==u.m_apIsolation?"1":"0")):(clearTimer(),clearValidateMsg(),d(n))},n.checkSettings=function(s){var e=c(),t=(i.getStatusInfo(),i.getAPStationBasic());return"ssid2"==s&&"1"==t.ap_station_enable&&"1"==n.accessPoint24gEnable()?(showAlert("ap_station_note_disable_info"),!0):"switch"!=s||"1"!=e.WpsStatus_1&&"1"!=e.WpsStatus_2?"ssid1"==s&&"1"==e.WpsStatus_1?(showAlert("wps_on_info"),!0):"ssid2"==s&&"1"==e.WpsStatus_2&&(showAlert("wps_on_info"),!0):(showAlert("wps_on_info"),!0)},n.saveSSID2=function(){return"0"==_().wifiSwitch?(showAlert("wps_wifi_off"),!0):"0"==n.accessPoint24gEnable()?(showAlert("wps_guest_wifi_off"),!0):void(n.checkSettings("ssid1")||showConfirm("wifi_disconnect_confirm",function(){n.saveSSID2Action()}))},n.saveSSID2Action=function(){showLoading();var s={};s.ChipIndex="0",s.AccessPointIndex="1",s.AccessPointSwitchStatus=n.accessPoint24gEnable(),s.originAccessPointSwitchStatus=n.originAccessPoint24gEnable(),s.AuthMode=n.m_selectedMode(),s.Password=n.m_passPhrase(),s.SSID=n.m_ssid(),s.ApBroadcastDisabled=n.m_broadcast(),s.QrImageShow=n.m_showQrCode()?"1":"0",s.ApMaxStationNumber=n.m_selectedStation(),s.cipher="WPA2PSK"==n.m_selectedMode()?"CCMP":"TKIPCCMP",s.ApIsolate=n.m_apIsolation(),i.setWifiAccessPointInfo(s,function(s){"success"==s.result?n.checkWifiStatus():errorOverlay()})},n.saveSSID2_5g=function(){n.checkSettings("ssid2")||showConfirm("wifi_disconnect_confirm",function(){n.saveSSID2Action_5g()})},n.saveSSID2Action_5g=function(){showLoading(),n.m_broadcast_5g(s("#mBroadcastCheckbox_5g:checked").length>0?"0":"1"),n.m_apIsolation_5g(s("#mApIsolatedCheckbox_5g:checked").length);var e={};e.ChipIndex="1",e.AccessPointIndex="1",e.AccessPointSwitchStatus=n.accessPoint50gEnable(),e.originAccessPointSwitchStatus=n.originAccessPoint50gEnable(),e.AuthMode=n.m_selectedMode_5g(),e.Password=n.m_passPhrase_5g(),e.SSID=n.m_ssid_5g(),e.ApBroadcastDisabled=n.m_broadcast_5g(),e.QrImageShow=n.m_showQrCode_5g()?"1":"0",e.ApMaxStationNumber=n.m_selectedStation_5g(),e.cipher="WPA2PSK"==n.m_selectedMode_5g()?"CCMP":"TKIPCCMP",e.ApIsolate=n.m_apIsolation_5g(),i.setWifiAccessPointInfo(e,function(s){"success"==s.result?n.checkWifiStatus():errorOverlay()})},n.setMultiSSIDSwitch=function(){if(!n.checkSettings("switch")){var e=function(){showLoading();var e={};t.WIFI_SWITCH_SUPPORT&&(e.SwitchOption=n.wifi_enable(),n.lan_sec_ssid_control(s("#allowAccessCheckbox:checked").length>0?"0":"1"),e.lan_sec_ssid_control=n.lan_sec_ssid_control()),i.setWifiModuleSwitchStatus(e,function(s){"success"==s.result?n.checkWifiStatus():errorOverlay()})};"0"==n.wifi_enable()?showConfirm("wifi_off_alert",function(){e()}):e()}},n.checkWifiStatus=function(){function s(){var e=i.getWifiModuleSwitchStatus();"0"!=e.WiFiModuleSwitch&&"1"!=e.WiFiModuleSwitch?addTimeout(s,1e3):setTimeout(function(){successOverlay(),l&&setTimeout(function(){window.location.reload()},1e3),clearTimer(),clearValidateMsg(),window.location.reload()},l?15e3:0)}setTimeout(function(){s()},2e3)},n.setGuestSSIDSwitch=function(){if(!n.checkSettings("ssid2")){!function(){showLoading();var e={};e.AccessPointSwitchStatus=n.accessPoint24gEnable(),n.lan_sec_ssid_control(s("#allowAccessCheckbox:checked").length>0?"0":"1"),e.lan_sec_ssid_control=n.lan_sec_ssid_control(),showLoading(),n.m_broadcast(s("#mBroadcastCheckbox:checked").length>0?"0":"1"),n.m_apIsolation(s("#mApIsolatedCheckbox:checked").length);var e={};e.ChipIndex="0",e.AccessPointIndex="1",e.AccessPointSwitchStatus=n.accessPoint24gEnable(),e.originAccessPointSwitchStatus=n.originAccessPoint24gEnable(),n.lan_sec_ssid_control(s("#allowAccessCheckbox:checked").length>0?"0":"1"),e.lan_sec_ssid_control=n.lan_sec_ssid_control(),e.AuthMode=n.m_selectedMode(),e.Password=n.m_passPhrase(),e.SSID=n.m_ssid(),e.ApBroadcastDisabled=n.m_broadcast(),e.QrImageShow=n.m_showQrCode()?"1":"0",e.ApMaxStationNumber=n.m_selectedStation(),e.cipher="WPA2PSK"==n.m_selectedMode()?"CCMP":"TKIPCCMP",e.ApIsolate=n.m_apIsolation(),i.setWifiAccessPointInfo(e,function(s){"success"==s.result?n.checkWifiStatus():errorOverlay()})}()}},n.showPasswordHandler=function(){s("#passShow").parent().find(".error").hide();var e=s("#showPassword:checked");e&&0==e.length?n.showPassword(!0):n.showPassword(!1)},n.m_showPasswordHandler=function(){s("#m_passShow").parent().find(".error").hide();var e=s("#m_showPassword:checked");e&&0==e.length?n.m_showPassword(!0):n.m_showPassword(!1)},n.m_showPasswordHandler_5g=function(){s("#m_passShow_5g").parent().find(".error").hide();var e=s("#m_showPassword_5g:checked");e&&0==e.length?n.m_showPassword_5g(!0):n.m_showPassword_5g(!1)}}function c(){var s=i.getWifiWpsStatus();return wifiWPSActiveInfo(s)}function r(){i.getParams({nv:"user_ip_addr"},function(s){i.getParams({nv:"station_list"},function(e){l=isWifiConnected(s.user_ip_addr,e.station_list)})})}function _(){var s=i.getWifiModuleSwitchStatus(),e=i.getWifiAccessPointInfo();return wifiFilterAPInfo(s,e,t.WIFICHIPINDEX.FIRST,t.ACCESSPOINTINDEX.FIRST,t.WIFICHIPINDEX,t.ACCESSPOINTINDEX)}function d(o){var a=s("#container");e.cleanNode(a[0]),S=!o;var c=new n;e.applyBindings(c,a[0]),addTimeout(function(){r()},600),t.AP_STATION_SUPPORT?function(){"1"==i.getAPStationBasic().ap_station_enable?s("#frmMultiSSID :input").each(function(){s(this).attr("disabled",!0)}):s("#frmMultiSSID :input").each(function(){s(this).attr("disabled",!1)})}():t.WDS_SUPPORT&&function(){"0"!=i.getWdsInfo().currentMode?(s("#frmWifiSwitch :input").each(function(){s(this).attr("disabled",!0)}),s("#frmSSID1 :input").each(function(){s(this).attr("disabled",!0)}),s("#frmSSID2 :input").each(function(){s(this).attr("disabled",!0)}),s("#frmGuestSSIDSwitch :input").each(function(){s(this).attr("disabled",!0)})):(s("#frmWifiSwitch :input").each(function(){s(this).attr("disabled",!1)}),s("#frmSSID1 :input").each(function(){s(this).attr("disabled",!1)}),s("#frmSSID2 :input").each(function(){s(this).attr("disabled",!1)}),s("#frmGuestSSIDSwitch :input").each(function(){s(this).attr("disabled",!1)}))}(),s("#frmWifiSwitch").validate({submitHandler:function(){c.setMultiSSIDSwitch()}}),s("#frmGuestSSIDSwitch").validate({submitHandler:function(){c.setGuestSSIDSwitch()}}),s("#frmSSID2").validate({submitHandler:function(){c.saveSSID2()},rules:{m_ssid:"ssid",m_pass:"wifi_password_check",m_passShow:"wifi_password_check"}}),s("#frmSSID2_5g").validate({submitHandler:function(){c.saveSSID2_5g()},rules:{m_ssid_5g:"ssid",m_pass_5g:"wifi_password_check",m_passShow_5g:"wifi_password_check"},errorPlacement:function(s,e){var t=e.attr("id");"pass_5g"==t||"passShow_5g"==t?s.insertAfter("#lblShowPassword_5g"):"m_pass_5g"==t||"m_passShow_5g"==t?s.insertAfter("#m_lblShowPassword_5g"):s.insertAfter(e)}})}var l=!1,S=!0,h=o.map(t.AUTH_MODES,function(s){return new Option(s.name,s.value)});return{init:d}});
//# sourceMappingURL=../../../sourcemaps/m/wifi/wifi_guest.js.map
