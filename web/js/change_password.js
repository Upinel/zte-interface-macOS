define(["jquery","knockout","config/config","service","underscore","home"],function(s,e,o,i,t,a){function n(s){for(var e=[],o=1;o<=s;o++)e.push(new Option(o,o));return e}function r(){var t=this;setTimeout(function(){var s=i.getParams({nv:["privacy_read_flag","loginfo","tr069_user_improv_notify_flag","dm_user_grant_notify_flag"]});"0"==s.privacy_read_flag&&"ok"==s.loginfo&&o.HAS_GDPR?showModifyFotaWindow("change_mode","privacy_policy","privacy_policy",700,400,function(){}):"0"==s.tr069_user_improv_notify_flag&&"ok"==s.loginfo?showModifyFotaWindow("change_mode","user_improv","user_improv",700,400,function(){}):"0"==s.dm_user_grant_notify_flag&&"ok"==s.loginfo&&showModifyFotaWindow("change_mode","user_grant","user_grant",700,400,function(){})},1e3),t.setSkipSetting=function(){i.setSkipSetting({},function(){window.location.reload()})};var a=d(),r=i.getParams({nv:"wifi_onoff_wifi5g_by_n79_mutex"}).wifi_onoff_wifi5g_by_n79_mutex;t.wifi5GIsOn=e.observable("1"!=r),t.hasWifiSwitch=o.WIFI_SWITCH_SUPPORT,t.hasGuestSSIDControl=o.WIFI_GUEST_SSID_ACCESS_SUPPORT,t.hasQRImg=o.WIFI_SUPPORT_QR_CODE,t.hasWifiMacFilter=o.WIFI_MAC_FILTER_SUPPORT,t.hasWifiDoubleChip=o.WIFI_DOUBLE_CHIP,t.hasMultiSSID=o.HAS_MULTI_SSID,t.showIsolated=o.SHOW_WIFI_AP_ISOLATED,t.wifi_enable=e.observable(a.wifiSwitch),t.accessPointEnable=e.observable(a.AccessPointSwitchStatus),t.originAccessPointEnable=e.observable(a.AccessPointSwitchStatus),t.isShowSSIDInfoDiv=e.observable(!1);var _=i.getParams({nv:"lan_sec_ssid_control"}).lan_sec_ssid_control;t.lan_sec_ssid_control=e.observable(_),o.WIFI_SWITCH_SUPPORT?"0"!=a.wifiSwitch?t.isShowSSIDInfoDiv(!0):t.isShowSSIDInfoDiv(!1):t.isShowSSIDInfoDiv(!0),t.origin_main_ssid_enable=a.wifiSwitch;var h="OPEN"==a.AuthMode;t.securityModeChangeHandler=function(){h&&(t.passPhrase(""),clearValidateMsg("#passwordContainer")),h="OPEN"==t.selectedSecurityMode()},t.maxStationNumber=e.computed(function(){return o.MAX_STATION_NUMBER}),t.securityModes=e.observableArray(S),t.selectedSecurityMode=e.observable(a.AuthMode),t.passPhrase=e.observable(a.Password),t.showPassword=e.observable(!1),t.ssid=e.observable(a.SSID),t.broadcast=e.observable("1"==a.ApBroadcastDisabled?"1":"0"),t.apIsolation=e.observable("1"==a.ApIsolate?"1":"0"),t.cipher=a.cipher,t.selectedStation=e.observable(a.ApMaxStationNumber),t.maxStations=e.observableArray(n(o.MAX_STATION_NUMBER)),t.showQrCode=e.observable(!("0"==a.QrImageShow)),t.qrcode_ssid1=e.observable(function(s){var e=(new Date).getTime();return s.QrImageUrl?s.QrImageUrl+"?_="+e:""}(a)),t.showQrCodeHandler=function(){s("#showQrCode").parent().find(".error").hide();var e=s("#showQrCode:checked");e&&0==e.length?t.showQrCode(!0):t.showQrCode(!1)};var f=i.getParams({nv:"wifi_syncparas_flag"}).wifi_syncparas_flag;t.syn24gAnd5g=e.observable(f),1==t.syn24gAnd5g()?s("input[name='ssid']").attr("maxlength","29"):s("input[name='ssid']").attr("maxlength","32"),t.showLoginPassword=e.observable(!1);var a=w(),h="OPEN"==a.AuthMode;t.securityModeChangeHandler_5G=function(){h&&(t.passPhrase(""),clearValidateMsg("#passwordContainer_5G")),h="OPEN"==t.selectedSecurityMode_5G()},t.maxStationNumber_5G=e.computed(function(){return o.MAX_STATION_NUMBER}),t.accessPointEnable_5G=e.observable(a.AccessPointSwitchStatus),t.originAccessPointEnable_5G=e.observable(a.AccessPointSwitchStatus),t.securityModes_5G=e.observableArray(S),t.selectedSecurityMode_5G=e.observable(a.AuthMode),t.passPhrase_5G=e.observable(a.Password),t.showPassword_5G=e.observable(!1),t.ssid_5G=e.observable(a.SSID),t.broadcast_5G=e.observable("1"==a.ApBroadcastDisabled?"1":"0"),t.apIsolation_5G=e.observable("1"==a.ApIsolate?"1":"0"),t.cipher_5G=a.cipher,t.selectedStation_5G=e.observable(a.ApMaxStationNumber),t.maxStations_5G=e.observableArray(n(o.MAX_STATION_NUMBER_5G)),t.showQrCode_5G=e.observable(!("0"==a.QrImageShow)),t.qrcode_ssid1_5G=e.observable(function(s){var e=(new Date).getTime();return s.QrImageUrl?s.QrImageUrl+"?_="+e:""}(a)),t.showQrCodeHandler_5G=function(){if(!s("#showQrCode_5G_p").hasClass("disable")&&!s("#showQrCode_5G_p").hasClass("checked_disable")){s("#showQrCode_5G").parent().find(".error").hide();var e=s("#showQrCode_5G:checked");e&&0==e.length?t.showQrCode_5G(!0):t.showQrCode_5G(!1)}},t.showPasswordHandler_5G=function(){if(!s("#showPassword_5G_p").hasClass("disable")&&!s("#showPassword_5G_p").hasClass("checked_disable")){s("#passShow_5G").parent().find(".error").hide();var e=s("#showPassword_5G:checked");e&&0==e.length?t.showPassword_5G(!0):t.showPassword_5G(!1)}},t.clear=function(s){if("switch"==s)t.wifi_enable(a.wifiSwitch);else if("ssid1"==s){t.selectedMode(a.AuthMode),t.passPhrase(a.Password),t.ssid(a.SSID),t.broadcast("1"==a.ApBroadcastDisabled?"1":"0"),t.cipher=a.cipher,t.selectedStation(a.ApMaxStationNumber),t.apIsolation("1"==a.ApIsolate?"1":"0");var e=i.getParams({nv:"wifi_syncparas_flag"}).wifi_syncparas_flag;t.syn24gAnd5g(e)}else"ssid2"==s?(t.m_selectedMode(a.AuthMode),t.m_passPhrase(a.Password),t.m_ssid(a.SSID),t.m_broadcast("1"==a.ApBroadcastDisabled?"1":"0"),t.m_cipher=a.cipher,t.m_selectedStation(a.ApMaxStationNumber),t.m_apIsolation("1"==a.ApIsolate?"1":"0")):(clearTimer(),clearValidateMsg(),l())},t.checkSettings=function(e){var n=c(),r=i.getStatusInfo();return"ssid1"==e&&"0"==t.accessPointEnable()&&"0"==a.AccessPointSwitchStatus_2_1?(showAlert("can_not_close_last_ssid"),!0):"ssid1"==e&&parseInt(t.selectedStation())<parseInt(r.station_num_ssid1)?(showAlert("can_not_modify_less_attached"),!0):"switch"!=e||"1"!=n.WpsStatus_1&&"1"!=n.WpsStatus_2?"ssid1"==e&&"1"==n.WpsStatus_1?(showAlert("wps_on_info"),!0):(t.syn24gAnd5g(s("#syn24gAnd5gCheckbox:checked").length),!(!o.HAS_MULTI_SSID||"1"!=a.AccessPointSwitchStatus_1_1||"1"!=a.AccessPointSwitchStatus_1_2||!("ssid1"==e&&parseInt(t.selectedStation())+parseInt(a.ApMaxStationNumber_1_2)>o.MAX_STATION_NUMBER||"ssid2"==e&&parseInt(t.m_selectedStation())+parseInt(a.MAX_Access_num)>o.MAX_STATION_NUMBER))&&(showAlert({msg:"multi_ssid_max_access_number_alert",params:o.MAX_STATION_NUMBER}),!0)):(showAlert("wps_on_info"),!0)},t.checkSettings_5G=function(s){var e=c(),o=i.getStatusInfo();return"ssid1_5G"==s&&"0"==t.accessPointEnable()&&"0"==a.AccessPointSwitchStatus_2_1?(showAlert("can_not_close_last_ssid"),!0):"ssid1_5G"==s&&parseInt(t.selectedStation_5G())<parseInt(o.station_num_ssid2)?(showAlert("can_not_modify_less_attached"),!0):"switch"!=s||"1"!=e.WpsStatus_1&&"1"!=e.WpsStatus_2?"ssid1_5G"==s&&"1"==e.WpsStatus_2&&(showAlert("wps_on_info"),!0):(showAlert("wps_on_info"),!0)},t.goToGuideImg1=function(){s("#wifiDiv").hide(),s("#guideImg1Div").show(),s("#guideImg2Div").hide()},t.backToGuide0=function(){s("#wifiDiv").show(),s("#guideImg1Div").hide(),s("#guideImg2Div").hide()},t.goToGuideImg2=function(){s("#wifiDiv").hide(),s("#guideImg1Div").hide(),s("#guideImg2Div").show()},t.backToGuide1=function(){s("#wifiDiv").hide(),s("#guideImg1Div").show(),s("#guideImg2Div").hide()},t.saveSSID1=function(){t.checkSettings("ssid1")||t.checkSettings_5G("ssid1")||showConfirm("wifi_disconnect_confirm",function(){t.saveSSID1Action_24G5G()})},t.saveSSID1Action_24G5G=function(){showLoading(),t.broadcast(s("#broadcastCheckbox:checked").length>0?"0":"1"),t.apIsolation(s("#apisolatedCheckbox:checked").length),t.syn24gAnd5g(s("#syn24gAnd5gCheckbox:checked").length),t.broadcast_5G(s("#broadcastCheckbox_5G:checked").length>0?"0":"1"),t.apIsolation_5G(s("#apisolatedCheckbox_5G:checked").length);var e={};e.goformId="setAccessPointInfo_24G_5G_ALL",e.ChipIndex="9",e.AccessPointIndex="0",e.wifi_syncparas_flag=t.syn24gAnd5g(),e.AccessPointSwitchStatus=t.accessPointEnable(),e.originAccessPointSwitchStatus=t.originAccessPointEnable(),e.AuthMode=t.selectedSecurityMode(),e.Password=t.passPhrase(),e.SSID=t.ssid(),e.ApMaxStationNumber=t.selectedStation(),e.ApIsolate=t.apIsolation(),e.ApBroadcastDisabled=t.broadcast(),e.QrImageShow=t.showQrCode()?"1":"0",e.cipher="WPA2PSK"==t.selectedSecurityMode()?"CCMP":"TKIPCCMP",e.wifi5GIsOn=t.wifi5GIsOn(),t.wifi5GIsOn()&&(e.AccessPointSwitchStatus_5G="1"==t.syn24gAnd5g()?t.accessPointEnable():t.accessPointEnable_5G(),e.originAccessPointSwitchStatus_5G="1"==t.syn24gAnd5g()?t.originAccessPointEnable():t.originAccessPointEnable_5G(),e.AuthMode_5G="1"==t.syn24gAnd5g()?t.selectedSecurityMode():t.selectedSecurityMode_5G(),e.Password_5G="1"==t.syn24gAnd5g()?t.passPhrase():t.passPhrase_5G(),e.SSID_5G="1"==t.syn24gAnd5g()?t.ssid()+"_5G":t.ssid_5G(),e.ApMaxStationNumber_5G=t.selectedStation_5G(),e.ApIsolate_5G="1"==t.syn24gAnd5g()?t.apIsolation():t.apIsolation_5G(),e.ApBroadcastDisabled_5G="1"==t.syn24gAnd5g()?t.broadcast():t.broadcast_5G(),e.QrImageShow_5G="1"==t.syn24gAnd5g()?t.showQrCode()?"1":"0":t.showQrCode_5G()?"1":"0",e.cipher_5G="1"==t.syn24gAnd5g()?"WPA2PSK"==t.selectedSecurityMode()?"CCMP":"TKIPCCMP":"WPA2PSK"==t.selectedSecurityMode_5G()?"CCMP":"TKIPCCMP"),i.setWifiAccessPointInfo_24G5G(e,function(s){"success"==s.result?t.checkWifiStatus():errorOverlay()})},t.showPasswordHandler=function(){s("#passShow").parent().find(".error").hide();var e=s("#showPassword:checked");e&&0==e.length?t.showPassword(!0):t.showPassword(!1)},t.syncTo5GHandler=function(){var e=s("#syn24gAnd5gCheckbox:checked");e&&0==e.length?(s("input[name='ssid']").attr("maxlength","29"),s("#ssid1_5G_title_div").hide(),s("#ssid1_5G_div").hide()):(s("input[name='ssid']").attr("maxlength","32"),s("#ssid1_5G_title_div").show(),s("#ssid1_5G_div").show())},t.syncTo5GHandler(),t.checkWifiStatus=function(){function s(){var e=i.getWifiModuleSwitchStatus();"0"!=e.WiFiModuleSwitch&&"1"!=e.WiFiModuleSwitch?addTimeout(s,1e3):setTimeout(function(){"0"==i.getParams({nv:["web_wifi_password_remind"]}).web_wifi_password_remind?window.location.reload():successOverlay(),u&&setTimeout(function(){window.location.reload()},1e3),"1"==t.accessPointEnable()?t.originAccessPointEnable("1"):t.originAccessPointEnable("0"),clearTimer(),clearValidateMsg(),l()},u?15e3:0)}setTimeout(function(){s()},2e3)},t.showLoginPasswordHandler=function(){s("#txtCurrentPasswordShow").parent().find(".error").hide(),s("#txtNewPasswordShow").parent().find(".error").hide(),s("#txtConfirmPasswordShow").parent().find(".error").hide();var e=s("#showLoginPassword:checked");e&&0==e.length?t.showLoginPassword(!0):t.showLoginPassword(!1)},t.currentPassword=e.observable(),t.newPassword=e.observable(),t.confirmPassword=e.observable(),t.changePassword=function(){var e={oldPassword:t.currentPassword(),newPassword:t.newPassword()};showLoading(),i.changePassword(e,function(e){if(t.cancel(),e&&1==e.result){var o=i.getParams({nv:["password_remind","web_wifi_password_remind"]});"0"==o.password_remind&&"0"==o.web_wifi_password_remind?window.location.reload():successOverlay()}else e&&"badPassword"==e.errorType?(hideLoading(),showAlert("current_password_error",function(){s("#txtCurrentPassword").focus()})):errorOverlay()})},t.cancel=function(){t.currentPassword(""),t.newPassword(""),t.confirmPassword("")}}function d(){var s=i.getWifiModuleSwitchStatus(),e=i.getWifiAccessPointInfo();return wifiFilterAPInfo(s,e,o.WIFICHIPINDEX.FIRST,o.ACCESSPOINTINDEX.FIRST,o.WIFICHIPINDEX,o.ACCESSPOINTINDEX)}function c(){var s=i.getWifiWpsStatus();return wifiWPSActiveInfo(s)}function _(){i.getParams({nv:"user_ip_addr"},function(s){i.getParams({nv:"station_list"},function(e){u=isWifiConnected(s.user_ip_addr,e.station_list)})})}function h(){showLoading();var s=i.getWifiModuleSwitchStatus();"0"!=s.WiFiModuleSwitch&&"1"!=s.WiFiModuleSwitch?addTimeout(h,1e3):hideLoading()}function w(){var s=i.getWifiModuleSwitchStatus(),e=i.getWifiAccessPointInfo();return wifiFilterAPInfo(s,e,o.WIFICHIPINDEX.SECOND,o.ACCESSPOINTINDEX.FIRST,o.WIFICHIPINDEX,o.ACCESSPOINTINDEX)}function l(){var t=s("#container");e.cleanNode(t[0]);var a=new r;e.applyBindings(a,t[0]),addTimeout(function(){_()},600),s("#passStrength").removeClass().addClass("passStrength0"),PasswordStrength("pass","passStrength"),PasswordStrength("passShow","passStrength"),s("#passStrength_5G").removeClass().addClass("passStrength0"),PasswordStrength("pass_5G","passStrength_5G"),PasswordStrength("passShow_5G","passStrength_5G"),o.WDS_SUPPORT&&function(){"0"!=i.getWdsInfo().currentMode?(s("#frmWifiSwitch :input").each(function(){s(this).prop("disabled",!0)}),s("#frmSSID1 :input").each(function(){s(this).prop("disabled",!0)}),s("#frmSSID1_5G :input").each(function(){s(this).prop("disabled",!0)})):(s("#frmWifiSwitch :input").each(function(){s(this).prop("disabled",!1)}),s("#frmSSID1 :input").each(function(){s(this).prop("disabled",!1)}),s("#frmSSID1_5G :input").each(function(){s(this).prop("disabled",!1)}))}(),s("#frmSSID1").validate({submitHandler:function(){a.goToGuideImg1()},rules:{ssid:"ssid",pass:"wifi_password_check",passShow:"wifi_password_check",ssid_5G:"ssid",pass_5G:"wifi_password_check",passShow_5G:"wifi_password_check"},errorPlacement:function(s,e){var o=e.attr("id");"pass"==o||"passShow"==o?s.insertAfter("#lblShowPassword"):"pass_5G"==o||"passShow_5G"==o?s.insertAfter("#lblShowPassword_5G"):s.insertAfter(e)}}),s("#frmChangePassword").validate({submitHandler:function(){a.changePassword()},rules:{txtCurrentPassword:"password_check",txtNewPassword:"password_check",txtConfirmPassword:{equalToPassword:"#txtNewPassword"},txtCurrentPasswordShow:"password_check",txtNewPasswordShow:"password_check",txtConfirmPasswordShow:{equalToPassword:"#txtNewPasswordShow"}}}),h()}var u=!1,S=t.map(o.AUTH_MODES,function(s){return new Option(s.name,s.value)});return{init:l}});
//# sourceMappingURL=../sourcemaps/change_password.js.map
