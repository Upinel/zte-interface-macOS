define(["jquery","knockout","config/config","service","underscore"],function(e,n,t,s,a){function i(e){for(var t=[],s=[],a=0;a<e.length;a++)for(var i=0;i<e[a].length;i++)-1==n.utils.arrayIndexOf(t,e[a][i])&&(t.push(e[a][i]),s.push({index:e[a][i],rate:D[e[a][i]]}));return s.sort(function(e,n){return e.rate-n.rate}),s}function o(e){var n=[],t=[0,1,2,3,7],s=[0,4,6,8,10,12,14,16,18],a=[0,5,9,11,13,15,17,19,20];switch(e){case"0":n.push(t);break;case"1":n.push(s);break;case"2":n.push(a);break;case"3":n.push(t),n.push(s);break;case"4":n.push(t),n.push(s),n.push(a);break;default:n.push(a)}return r(i(n))}function r(e){for(var n=[],t=0;t<e.length;t++){var s=0==e[t].rate?"Auto":e[t].rate+" Mbps";n.push(new Option(s,e[t].index))}return n}function c(e){var n=[new Option("Auto","0")];switch(S(e)+""){case"1":l(n,2407,11);break;case"3":l(n,2407,11),l(n,2462,2);break;case"7":l(n,2307,13),l(n,2407,11),l(n,2462,2);break;default:l(n,2407,11)}return n}function d(n){for(key in t.countryCode_5g){var s=t.countryCode_5g[key];if(-1!=e.inArray(n,s.codes))return u(s.channels)}return[new Option("Auto","0")]}function l(e,n,t){for(var s=1;s<=t;s++){var a=n+5*s+"MHz (Channel "+e.length+")";e.push(new Option(a,e.length+"_"+(n+5*s)))}}function u(e){for(var n=[new Option("Auto","0")],t=0;t<e.length;t++){var s=e[t],a=5e3+5*s,i=a+"MHz (Channel "+s+")";n.push(new Option(i,s+"_"+a))}return n}function _(){var e=[];return e.push(new Option("2.4GHz","b")),e}function f(){var e=[];return e.push(new Option("5GHz","a")),e}function h(e){var n=[];return e?(n.push(new Option("20MHz","0")),n.push(new Option("40MHz","2")),n.push(new Option("20MHz/40MHz","1"))):n.push(new Option("20MHz","0")),n}function p(e){var n=[];return"2"==e?(n.push(new Option("20MHz","0")),n.push(new Option("20MHz/40MHz","1"))):"3"==e?(n.push(new Option("20MHz","0")),n.push(new Option("20MHz/40MHz","1")),n.push(new Option("20MHz/40MHz/80MHz","4"))):n.push(new Option("20MHz","0")),n}function S(n){var s=t.countryCode,a="";for(key in s){var i=s[key];if(-1!=e.inArray(n,i)){a=key;break}}var o=t.countryCodeType[a];return o||"0"}function g(e){var n=e?t.countries_5g:t.countries,s=[];for(key in n)s.push(new Option(n[key],key));return s=a.sortBy(s,function(e){return e.text})}function w(n){var s="a"==n?t.NETWORK_MODES_BAND:t.NETWORK_MODES;1==s.length?(e("#mode").hide(),e("#modeFor5HZ").hide()):(e("#modeFor5HZ").show(),e("#mode").show(),e("#modeLabel").attr("for","mode"),e("#modeLabel_5g").attr("for","modeFor5HZ"));for(var a=[],i=0;i<s.length;i++)a.push(new Option(s[i].name,s[i].value));return a}function v(e,n){for(var t=0;t<n.length;t++){var s=n[t];if(s.text==e+" Mbps")return s.value}return"0"}function b(n,t){for(var s=0;s<t.length;s++){var a=e(t[s]);if(a.val().split("_")[0]==n)return a.val()}return"0"}function I(e){for(var n=[],t=1;t<=e;t++)n.push(new Option(t,t));return n}function C(e,n,t){return"0"==e?"0":"1"==n&&"1"==t?"chip1_2":"1"==n&&"1"!=t?"chip1":"1"!=n&&"1"==t?"chip2":"chip1_2"}function A(e,n){return"1"==e||"1"==n?"1":"0"}function M(){var a=this;a.maxStations=n.observableArray(I(parseInt(t.MAX_STATION_NUMBER)+parseInt(t.MAX_STATION_NUMBER_5G)));var i=s.getWifiModuleSwitchStatus(),r=s.getWifiAccessPointInfo(),l=m(i,r),u=s.getParams({nv:"wifi_onoff_wifi5g_by_n79_mutex"}).wifi_onoff_wifi5g_by_n79_mutex;a.wifi5GIsOn=n.observable("1"!=u),a.selectedStation=n.observable(l.ApMaxStationNumber);var S=O();a.wifiRangeMode=n.observable(S.wifiRangeMode),a.isCPE="CPE"==t.PRODUCT_TYPE,a.hasWifiSwitch=t.WIFI_SWITCH_SUPPORT,a.hasGuestSSIDControl=t.WIFI_GUEST_SSID_ACCESS_SUPPORT,a.hasMultiSSID=t.HAS_MULTI_SSID,a.showIsolated=t.SHOW_WIFI_AP_ISOLATED;var M=C(l.wifiSwitch,l.AccessPointSwitchStatus_1_1,l.AccessPointSwitchStatus_2_1);a.wifi_enable=n.observable(l.wifiSwitch);var T=s.getParams({nv:"lan_sec_ssid_control"}).lan_sec_ssid_control;a.lan_sec_ssid_control=n.observable(T);var D=A(l.AccessPointSwitchStatus_1_2,l.AccessPointSwitchStatus_2_2);a.multi_ssid_enable=n.observable(D),a.origin_main_ssid_enable=n.observable(M),a.origin_multi_ssid_enable=D,a.isShowSSIDInfoDiv=n.observable(!1),t.WIFI_SWITCH_SUPPORT?"0"!=l.wifiSwitch?a.isShowSSIDInfoDiv(!0):a.isShowSSIDInfoDiv(!1):a.isShowSSIDInfoDiv(!0),a.clear=function(e){"switch"==e?a.wifi_enable(l.wifiSwitch):"ssid1"==e?(a.selectedMode(l.AuthMode),a.passPhrase(l.Password),a.ssid(l.SSID),a.broadcast("1"==l.ApBroadcastDisabled?"1":"0"),a.cipher=l.cipher,a.selectedStation(l.ApMaxStationNumber),a.apIsolation("1"==l.ApIsolate?"1":"0"),a.syn24gAnd5g("0")):"ssid2"==e?(a.m_selectedMode(l.AuthMode),a.m_passPhrase(l.Password),a.m_ssid(l.SSID),a.m_broadcast("1"==l.ApBroadcastDisabled?"1":"0"),a.m_cipher=l.cipher,a.m_selectedStation(l.ApMaxStationNumber),a.m_apIsolation("1"==l.ApIsolate?"1":"0")):(clearTimer(),clearValidateMsg(),B())},a.checkSettings=function(e){var n=y(),i=s.getStatusInfo();return"ssid1"!=e||"2"!=i.wifi_dfs_status&&"3"!=i.wifi_dfs_status?"ssid1"==e&&parseInt(a.selectedStation())<parseInt(i.station_num_ssid2)?(showAlert("can_not_modify_less_attached"),!0):"switch"!=e||"1"!=n.WpsStatus_1&&"1"!=n.WpsStatus_2?"ssid1"==e&&"1"==n.WpsStatus_2?(showAlert("wps_on_info"),!0):!(!t.HAS_MULTI_SSID||"1"!=l.AccessPointSwitchStatus_2_2||!("ssid1"==e&&(parseInt(a.selectedStation())+parseInt(l.ApMaxStationNumber_2_2)>t.MAX_STATION_NUMBER||"1"==a.syn24gAnd5g()&&2*parseInt(a.selectedStation())>t.MAX_STATION_NUMBER)||"ssid2"==e&&(parseInt(a.m_selectedStation())+parseInt(l.MAX_Access_num)>t.MAX_STATION_NUMBER||"1"==a.syn24gAnd5g()&&2*parseInt(a.m_selectedStation())>t.MAX_STATION_NUMBER)))&&(showAlert({msg:"multi_ssid_max_access_number_alert",params:t.MAX_STATION_NUMBER}),!0):(showAlert("wps_on_info"),!0):(showAlert("dfs_is_going"),!0)},a.setMultiSSIDSwitch=function(){if(!a.checkSettings("switch")){var n=function(){showLoading();var n={};t.WIFI_SWITCH_SUPPORT&&(n.SwitchOption=a.wifi_enable(),a.lan_sec_ssid_control(e("#allowAccessCheckbox:checked").length>0?"0":"1"),n.lan_sec_ssid_control=a.lan_sec_ssid_control()),s.setWifiModuleSwitchStatus(n,function(e){"success"==e.result?a.checkWifiStatus():errorOverlay()})};"0"==a.wifi_enable()?showConfirm("wifi_off_alert",function(){n()}):n()}},a.checkWifiStatus=function(){function e(){var n=s.getWifiModuleSwitchStatus();"0"!=n.WiFiModuleSwitch&&"1"!=n.WiFiModuleSwitch?addTimeout(e,1e3):setTimeout(function(){successOverlay(),P&&setTimeout(function(){window.location.reload()},1e3),clearTimer(),clearValidateMsg(),B()},P?15e3:0)}setTimeout(function(){e()},2e3)};var H=l;a.modes=n.observableArray(w(H.Band)),a.bands=n.observableArray(_());var N=g("a"==H.wifiBand);a.countries=n.observableArray(N),a.channels=n.observableArray(c(H.CountryCode)),a.rates=n.observableArray(o(H.WirelessMode)),a.hasWifiBand=n.observable(t.WIFI_BAND_SUPPORT),a.hasBandwidth=n.observable(t.WIFI_BANDWIDTH_SUPPORT),a.selectedBand=n.observable(H.Band),a.selectedChannelBandwidth=n.observable(H.BandWidth),a.selectedMode=n.observable(H.WirelessMode),a.selectedCountry=n.observable(H.CountryCode.toUpperCase()),a.selectedChannel=n.observable(b(H.Channel,a.channels())),a.selectedRate=n.observable(v(H.rate,a.rates())),a.oneBandTrans=n.observable("a"==H.Band?"5G":"2.4G"),a.oneModeTrans=n.observable(("a"==H.Band?"network_modes_band_select_":"network_mode_select_")+H.WirelessMode),a.channelBandwidths=n.computed(function(){return h("2"==a.selectedMode()||"4"==a.selectedMode()||"7"==a.selectedMode()?!0:!1)}),a.bandChangeHandler=function(){"a"==a.selectedBand()?(a.modes(w(a.selectedBand())),a.countries(g(!0))):(a.modes(w(a.selectedBand())),a.countries(g(!1))),a.selectedCountry("0"),a.channels(a.generateChannelOption()),a.selectedChannel("0")},a.modeChangeHandler=function(e,n){var t=o(a.selectedMode());a.rates(t),a.selectedRate("0")},a.countryChangeHandler=function(e,n){var t=a.generateChannelOption();a.channels(t),a.selectedChannel("0"),a.selectedCountry_5g(a.selectedCountry()),a.countryChangeHandler_5g(e,n)},a.generateChannelOption=function(){return"a"==a.selectedBand()?d(a.selectedCountry()):c(a.selectedCountry())};var R=W(i,r);a.modes_5g=n.observableArray(w(R.Band)),a.bands_5g=n.observableArray(f());var N=g("a"==R.Band);a.countries_5g=n.observableArray(N),a.channels_5g=n.observableArray(d(R.CountryCode)),a.rates_5g=n.observableArray(o(R.WirelessMode)),a.hasWifiBand=n.observable(t.WIFI_BAND_SUPPORT),a.hasBandwidth=n.observable(t.WIFI_BANDWIDTH_SUPPORT),a.selectedBand_5g=n.observable(R.Band),a.selectedChannelBandwidth_5g=n.observable(R.BandWidth),a.selectedMode_5g=n.observable(R.WirelessMode),a.selectedCountry_5g=n.observable(R.CountryCode.toUpperCase()),a.selectedChannel_5g=n.observable(b(R.Channel,a.channels_5g())),a.selectedRate_5g=n.observable(v(R.rate,a.rates_5g())),a.oneBandTrans_5g=n.observable("a"==R.Band?"5G":"2.4G"),a.oneModeTrans_5g=n.observable(("a"==R.Band?"network_modes_band_select_":"network_mode_select_")+R.WirelessMode),a.channelBandwidths_5g=n.computed(function(){return p("2"==a.selectedMode_5g()||"4"==a.selectedMode_5g()?"2":"6"==a.selectedMode_5g()||"8"==a.selectedMode_5g()?"3":"1")}),a.bandChangeHandler_5g=function(){"a"==a.selectedBand_5g()?(a.modes_5g(w(a.selectedBand())),a.countries_5g(g(!0))):(a.modes_5g(w(a.selectedBand())),a.countries_5g(g(!1))),a.selectedCountry_5g("0"),a.channels_5g(a.generateChannelOption_5g()),a.selectedChannel_5g("0")},a.modeChangeHandler_5g=function(e,n){var t=o(a.selectedMode_5g());a.rates_5g(t),a.selectedRate_5g("0")},a.countryChangeHandler_5g=function(e,n){var t=a.generateChannelOption_5g();a.channels_5g(t),a.selectedChannel_5g("0")},a.generateChannelOption_5g=function(){return"a"==a.selectedBand_5g()?d(a.selectedCountry()):c(a.selectedCountry())},a.save=function(){if("1"==y().WpsStatus_1)return void showAlert("wps_on_info");if(s.getCurrentlyAttachedDevicesInfo().attachedDevices.length>a.selectedStation())return showAlert("can_not_modify_less_attached"),!0;var n=e("#rate option:selected").text(),i=null;i=n==e.i18n.prop("rate_0")?0:e.trim(n.replace("Mbps",""));var o={};o.ChipIndex="8",o.WirelessMode=a.selectedMode(),o.CountryCode=a.selectedCountry();var r=a.selectedChannel();if(o.Channel="0"==r?"0":r.split("_")[0],o.rate=i,o.Band=a.selectedBand(),t.WIFI_BANDWIDTH_SUPPORT&&(o.BandWidth=a.selectedChannelBandwidth()),o.wifi5GIsOn=a.wifi5GIsOn(),a.wifi5GIsOn()){var c=e("#rate_5g option:selected").text(),d=null;d=c==e.i18n.prop("rate_0")?0:e.trim(c.replace("Mbps","")),o.WirelessMode_5G=a.selectedMode_5g(),o.CountryCode_5G=a.selectedCountry_5g();var l=a.selectedChannel_5g();o.Channel_5G="0"==l?"0":l.split("_")[0],o.rate_5G=d,o.Band_5G=a.selectedBand_5g(),t.WIFI_BANDWIDTH_SUPPORT&&(o.BandWidth_5G=a.selectedChannelBandwidth_5g())}o.ApMaxStationNumber=a.selectedStation(),showConfirm("wifi_disconnect_confirm",function(){showLoading(),s.setWifiWholeChipAdvanceInfo(o,function(e){"success"==e.result?a.checkWifiStatus():errorOverlay()})})},a.save_5g=function(){if("1"==y().WpsStatus_2)return void showAlert("wps_on_info");var n=s.getStatusInfo();if("2"==n.wifi_dfs_status||"3"==n.wifi_dfs_status)return showAlert("dfs_is_going"),!0;var i=e("#rate_5g option:selected").text(),o=null;o=i==e.i18n.prop("rate_0")?0:e.trim(i.replace("Mbps",""));var r={};r.ChipIndex="1",r.WirelessMode=a.selectedMode_5g(),r.CountryCode=a.selectedCountry_5g();var c=a.selectedChannel_5g();r.Channel="0"==c?"0":c.split("_")[0],r.rate=o,r.Band=a.selectedBand_5g(),t.WIFI_BANDWIDTH_SUPPORT&&(r.BandWidth=a.selectedChannelBandwidth_5g()),showConfirm("wifi_disconnect_confirm",function(){showLoading(),s.setWifiChipAdvanceInfo(r,function(e){"success"==e.result?setTimeout(function(){successOverlay(),P&&setTimeout(function(){window.location.reload()},1e3)},P?15e3:0):errorOverlay()})})},a.setWifiRange=function(){var e=y();if("0"==s.getWifiModuleSwitchStatus().WiFiModuleSwitch)return showAlert("wps_wifi_off"),!0;if("1"==e.WpsStatus_1||"1"==e.WpsStatus_2)return showAlert("wps_on_info"),!0;var n=s.getStatusInfo();if("2"==n.wifi_dfs_status||"3"==n.wifi_dfs_status)return showAlert("dfs_is_going"),!0;showLoading(),a.setWifiRangeAct()},a.setWifiRangeAct=function(){var e={};e.WiFiCoverage=a.wifiRangeMode(),s.setWifiCoverageInfo(e,function(e){"success"==e.result?a.checkWifiStatus():errorOverlay()})}}function m(e,n){return wifiFilterAPInfo(e,n,t.WIFICHIPINDEX.FIRST,t.ACCESSPOINTINDEX.FIRST,t.WIFICHIPINDEX,t.ACCESSPOINTINDEX)}function W(e,n){return wifiFilterAPInfo(e,n,t.WIFICHIPINDEX.SECOND,t.ACCESSPOINTINDEX.FIRST,t.WIFICHIPINDEX,t.ACCESSPOINTINDEX)}function O(){return s.getWifiCoverageInfo()}function y(){var e=s.getWifiWpsStatus();return wifiWPSActiveInfo(e)}function T(){s.getParams({nv:"user_ip_addr"},function(e){s.getParams({nv:"station_list"},function(n){P=isWifiConnected(e.user_ip_addr,n.station_list)})})}function B(){function a(n){"connect"==n.ex_wifi_status&&"athsta1"==n.wifi_station_ifname?(e("#wifi_advance_form_24g_5g input").each(function(){e(this).prop("disabled",!0)}),e("#wifi_advance_form_24g_5g select").each(function(){e(this).prop("disabled",!0)})):(e("#wifi_advance_form_24g_5g input").each(function(){e(this).prop("disabled",!1)}),e("#wifi_advance_form_24g_5g select").each(function(){e(this).prop("disabled",!1)}))}var i=e("#container");n.cleanNode(i[0]);var o=new M;n.applyBindings(o,i[0]),addTimeout(function(){T()},600),addInterval(function(){a(s.getStatusInfo())},1e3),t.AP_STATION_SUPPORT?function(){"1"==s.getAPStationBasic().ap_station_enable?e("#frmMultiSSID :input").each(function(){e(this).prop("disabled",!0)}):e("#frmMultiSSID :input").each(function(){e(this).prop("disabled",!1)})}():t.WDS_SUPPORT&&function(){"0"!=s.getWdsInfo().currentMode?(e("#frmWifiSwitch :input").each(function(){e(this).prop("disabled",!0)}),e("#frmSSID1 :input").each(function(){e(this).prop("disabled",!0)})):(e("#frmWifiSwitch :input").each(function(){e(this).prop("disabled",!1)}),e("#frmSSID1 :input").each(function(){e(this).prop("disabled",!1)}))}(),e("#frmWifiSwitch").validate({submitHandler:function(){o.setMultiSSIDSwitch()}}),e("#wifi_advance_form_24g_5g").validate({submitHandler:function(){o.save()}}),e("#wifiRangeForm").validate({submitHandler:function(){o.setWifiRange()}})}var P=!1,D=[0,1,2,5.5,6,6.5,9,11,12,13,18,19.5,24,26,36,39,48,52,54,58.5,65];a.map(t.AUTH_MODES,function(e){return new Option(e.name,e.value)});return{init:B}});
//# sourceMappingURL=../../sourcemaps/wifi/wifi_advance.js.map
