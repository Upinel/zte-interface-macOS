define(["jquery","knockout","config/config","service","underscore"],function(e,o,n,s,t){function r(){var t=this,r=s.getsleepProtection();t.sleepProtectionEnable=o.observable("1"==r.night_mode_switch?"1":"0"),t.openH_led=o.observable(r.openH),t.openM_led=o.observable(r.openM),t.closeH_led=o.observable(r.closeH),t.closeM_led=o.observable(r.closeM),t.nightMode=o.observable(r.night_mode_close_all_led),t.saveSleepProtection=function(){showLoading(),s.saveSleepProtection({sleepProtectionEnable:t.sleepProtectionEnable(),openTime:leftInsert(t.openH_led(),2,"0")+":"+leftInsert(t.openM_led(),2,"0"),closeTime:leftInsert(t.closeH_led(),2,"0")+":"+leftInsert(t.closeM_led(),2,"0"),night_mode_close_all_led:"1"},function(e){e&&"success"==e.result?successOverlay():errorOverlay()},e.noop)},t.setNightMode=function(){if(!e("#nightModeBtn").hasClass("disable")){var o=e("#nightMode:checked");o&&0==o.length?t.nightMode("1"):t.nightMode("0")}};var i=l();t.isCPE=-1!=n.DEVICE.toLowerCase().indexOf("cpe"),t.showTSWDiv=n.TSW_SUPPORT,t.showSleepDiv=n.WIFI_SLEEP_SUPPORT,t.showAutoPowerSave=n.AUTO_POWER_SAVE_SUPPORT,t.wanMode=n.opms_wan_mode,t.modes=o.observableArray(c),t.selectedMode=o.observable(i.sleepMode);var f=a(),d=s.getAutoPowerSave();t.wifiRangeMode=o.observable(f.wifiRangeMode),t.autoPowerSaveMode=o.observable(d.autoPowerSaveMode),t.setSleepMode=function(){showLoading(),s.getWpsInfo({},function(e){"0"==e.radioFlag?showAlert("wps_wifi_off"):"1"==e.wpsFlag?showAlert("wps_on_info"):t.setSleepModeAct()})},t.setSleepModeAct=function(){var e={};e.sleepMode=t.selectedMode(),s.setSleepMode(e,function(e){"success"==e.result?successOverlay():errorOverlay()})},t.setWifiRange=function(){showLoading(),s.getWpsInfo({},function(e){"0"==e.radioFlag?showAlert("wps_wifi_off"):"1"==e.wpsFlag?showAlert("wps_on_info"):t.setWifiRangeAct()})},t.setWifiRangeAct=function(){var e={};e.WiFiCoverage=t.wifiRangeMode(),s.setWifiCoverageInfo(e,function(e){"success"==e.result?successOverlay():errorOverlay()})},t.setAutoPowerSave=function(){showLoading(),s.getWpsInfo({},function(e){"0"==e.radioFlag?showAlert("wps_wifi_off"):"1"==e.wpsFlag?showAlert("wps_on_info"):t.setAutoPowerSaveAct()})},t.setAutoPowerSaveAct=function(){var e={};e.autoPowerSaveMode=t.autoPowerSaveMode(),s.setAutoPowerSave(e,function(e){"success"==e.result?successOverlay():errorOverlay()})};var p=s.getTsw();t.openEnable=o.observable(""==p.web_wake_switch?"0":p.web_wake_switch),t.openH=o.observable(p.openH),t.openM=o.observable(p.openM),t.closeH=o.observable(p.closeH),t.closeM=o.observable(p.closeM),t.saveTsw=function(){showLoading();var o=s.getWpsInfo();return"0"==o.radioFlag?(showAlert("wps_wifi_off"),!1):"1"==o.wpsFlag?(showAlert("wps_on_info"),!1):void("1"==t.openEnable()?s.getSysTimeMode({},function(o){o.result?s.saveTsw({openEnable:t.openEnable(),closeEnable:t.openEnable(),openTime:leftInsert(t.openH(),2,"0")+":"+leftInsert(t.openM(),2,"0"),closeTime:leftInsert(t.closeH(),2,"0")+":"+leftInsert(t.closeM(),2,"0")},function(e){e&&"success"==e.result?successOverlay():errorOverlay()},e.noop):showAlert("tsw_sys_time_mode_alert")}):s.saveTsw({openEnable:t.openEnable(),closeEnable:t.openEnable()},function(e){e&&"success"==e.result?successOverlay():errorOverlay()},e.noop))}}function a(){return s.getWifiCoverageInfo()}function l(){return s.getSleepMode()}function i(){var n=e("#container");o.cleanNode(n[0]);var s=new r;o.applyBindings(s,n[0]),e("#sleepModeForm").validate({submitHandler:function(){s.setSleepMode()}}),e("#wifiRangeForm").validate({submitHandler:function(){s.setWifiRange()}}),e("#autoPowerSaveForm").validate({submitHandler:function(){s.setAutoPowerSave()}}),e("#frmTsw").validate({submitHandler:function(){if(Math.abs(60*s.openH()+parseInt(s.openM(),10)-(60*s.closeH()+parseInt(s.closeM(),10)))<10)return showAlert("tsw_time_interval_alert"),!1;s.saveTsw()},rules:{openH:{any_digits:!0,range:[0,23]},openM:{any_digits:!0,range:[0,59]},closeH:{any_digits:!0,range:[0,23]},closeM:{any_digits:!0,range:[0,59]}},errorPlacement:function(o,n){"openH"==n.attr("name")||"openM"==n.attr("name")?e("#openErrorDiv").html(o):"closeH"==n.attr("name")||"closeM"==n.attr("name")?e("#closeErrorDiv").html(o):o.insertAfter(n)}}),e("#frmSleepProtection").validate({submitHandler:function(){s.saveSleepProtection()},rules:{openH:{any_digits:!0,range:[0,23]},openM:{any_digits:!0,range:[0,59]},closeH:{any_digits:!0,range:[0,23]},closeM:{any_digits:!0,range:[0,59]}},errorPlacement:function(o,n){"openH"==n.attr("name")||"openM"==n.attr("name")?e("#openErrorDiv_led").html(o):"closeH"==n.attr("name")||"closeM"==n.attr("name")?e("#openErrorDiv_led").html(o):o.insertAfter(n)}})}var c=t.map(n.SLEEP_MODES,function(e){return new Option(e.name,e.value)});return{init:i}});
//# sourceMappingURL=../../sourcemaps/wifi/sleep_mode.js.map
