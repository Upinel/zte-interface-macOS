define(["jquery","knockout","config/config","service","underscore"],function(e,s,r,t,a){function i(){var a=this,i=t.getStaticMacIpAddressList(),c=t.getDHCPStaticAddressRules(),l=t.getBindIPInfo();a.rules=s.observableArray(i.StaticAddressFilterRules),a.hostName=s.observable(l.host_name_web),a.macAddress=s.observable(l.mac_addr_web),a.ipAddress=s.observable(l.ip_addr_web),a.domainName=s.observable(),a.showDomainName=s.observable("0"),a.gridTemplate=new s.simpleGrid.viewModel({data:a.rules(),idName:"index",primaryColumn:"macAddress",columns:h,tmplType:"list",pageSize:10}),a.StaticAddressFlag=s.observable(c.mac_ip_status),a.isShowStaticAddressDiv=s.observable(!1),c.mac_ip_status?a.isShowStaticAddressDiv(!0):a.isShowStaticAddressDiv(!1),a.setDomainNameVisible=function(){if(!e("#domainBtn").hasClass("disable")){var s=e("#showDomainCheckbox:checked");s&&0==s.length?(a.showDomainName("1"),e("#txtDomainName").addClass("required"),e("#txtDomainName").parent().prev().children().css("visibility","visible")):(a.showDomainName("0"),e("#txtDomainName").parent().prev().children().css("visibility","hidden"),clearValidateMsg("#domainErrorDiv"))}},a.clear=function(){e("#hostName").val(""),e("#txtMacAddress").val(""),e("#txtIpAddress").val(""),e("#txtDomainName").val(""),e("#hostName").focus()},a.callback=function(s){"success"==s.result?(a.clear(),u(),successOverlay(),e("#staticAddress").translate()):errorOverlay()},a.addRule=function(){if(a.rules().length>=r.staticMacIPAddress)return showAlert({msg:"mac_ip_address_filter_max",params:r.staticMacIPAddress}),!1;if(l.ipAddress==a.ipAddress())return showAlert("ip_gate_not_same"),!1;if(!n(l.ipAddress,l.subnetMask,a.ipAddress()))return showAlert("static_address_check"),!1;if(!d(a.ipAddress(),i))return showAlert("the_only_ipAddress"),!1;if(!o(a.macAddress(),i))return showAlert("the_only_macAddress"),!1;showLoading();var e={goformId:"DHCP_RESERVATION_ADD",host_name:a.hostName(),mac_addr:a.macAddress(),ip_addr:a.ipAddress(),domain:a.domainName()};t.addStaticAddress(e,a.callback)},a.deleteRule=function(){showConfirm("confirm_data_delete",function(){showLoading();var e={goformId:"DHCP_RESERVATION_DEL",mac_addr:a.gridTemplate.selectedPrimaryValue().join(";")+";"};t.delStaticAddrRules(e,a.callback)})},a.restart=function(){showConfirm("restart_confirm",function(){showLoading("restarting"),t.restart({},function(e){e&&"success"==e.result?successOverlay():errorOverlay()},e.noop)})}}function n(e,s,r){return m(e,s,r)}function d(s,r){for(var t=r.StaticAddressFilterRules,a=s,i=[],n=[],d=0;d<t.length;d++){var o={};o.ipAddress=t[d].ipAddress,i.push(o)}for(var d=0;d<i.length;d++)n.push(i[d].ipAddress);return-1==e.inArray(a,n)}function o(s,r){for(var t=r.StaticAddressFilterRules,a=s,i=[],n=[],d=0;d<t.length;d++){var o={};o.macAddress=t[d].macAddress,i.push(o)}for(var d=0;d<i.length;d++)n.push(i[d].macAddress);return-1==e.inArray(a,n)}function c(e){var s=(e-0).toString(16);return 1==s.length&&(s="0"+s),s.toUpperCase()}function l(e,s){var r,t=[],a=[],i="0x";for(r=2,j=0;r<10;r+=2,j++)t[j]="0x"+e.substring(r,r+2),a[j]="0x"+s.substring(r,r+2);for(r=0;r<4;r++)i+=c(t[r]&a[r]);return i-0}function m(e,s,r){var t,a,i,n,d,o,m,u,h,p,f;return t=e.indexOf("."),a=e.indexOf(".",t+1),i=e.indexOf(".",a+1),n=c(e.substring(0,t))+c(e.substring(t+1,a))+c(e.substring(a+1,i))+c(e.substring(i+1,e.length)),n="0x"+n,m=e.substring(i+1,e.length)-0,t=s.indexOf("."),a=s.indexOf(".",t+1),i=s.indexOf(".",a+1),d=c(s.substring(0,t))+c(s.substring(t+1,a))+c(s.substring(a+1,i))+c(s.substring(i+1,s.length)),d="0x"+d,u=s.substring(i+1,s.length)-0,t=r.indexOf("."),a=r.indexOf(".",t+1),i=r.indexOf(".",a+1),o=c(r.substring(0,t))+c(r.substring(t+1,a))+c(r.substring(a+1,i))+c(r.substring(i+1,r.length)),o="0x"+o,h=r.substring(i+1,r.length)-0,l(n,d)==l(o,d)&&(p=m&u,f=255-u+(m&u),!(h==p||h==f))}function u(){var r=e("#container");s.cleanNode(r[0]);var t=new i;s.applyBindings(t,r[0]),e("#bindMACIPContentFrm").validate({submitHandler:function(){t.addRule()},rules:{domainName:"name_check",hostName:"name_check",txtMacAddress:{mac_check:!0},txtIpAddress:{ip_check:!0}},errorPlacement:function(e,s){"hostName"==s.attr("name")&&e.appendTo("#hostNameLabel"),"txtMacAddress"==s.attr("name")&&e.appendTo("#macErrorDiv"),"txtIpAddress"==s.attr("name")&&e.appendTo("#ipErrorDiv"),"txtDomainName"==s.attr("name")&&e.appendTo("#domainErrorDiv")}}),e("#bindMACIPListFrm").validate({submitHandler:function(){t.deleteRule()}})}var h=[{columnType:"checkbox",rowText:"index",width:"10%"},{headerTextTrans:"host_name",rowText:"hostName",width:"25%",trans:!0},{headerTextTrans:"mac_address",rowText:"macAddress",width:"20%",trans:!0},{headerTextTrans:"ip_address",rowText:"ipAddress",width:"20%",trans:!0},{headerTextTrans:"domain_name",rowText:"domainName",width:"25%",trans:!0}];return{init:u}});
//# sourceMappingURL=../../sourcemaps/adm/bind_addr_autocomplet.js.map
