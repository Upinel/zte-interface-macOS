var globalTime="";define(["jquery","knockout","config/config","service"],function(e,o,t,r){function n(){function t(e){return""!=e&&" "!=e||(e=0),e<10?"0"+parseInt(e,10):e}r.setSNTPDate({goformId:"SNTP_Getdatastatic"});var n=this,a=r.getSntpParams();globalTime=new Date(parseInt(a.sntp_year,10),parseInt(a.sntp_month,10)-1,parseInt(a.sntp_day,10),parseInt(a.sntp_hour,10),parseInt(a.sntp_minute,10),parseInt(a.sntp_second,10)),n.currentTime=o.observable("");var s=r.getRebootInfo();n.enableReboot=o.observable("1"==s.reboot_schedule_enable),n.isAllowedReboot=o.observable(s.reboot_schedule_enable),n.isRebootMode=o.observable(s.reboot_schedule_mode),n.weekHour=o.observable(t(s.reboot_hour1)),n.weekMinutes=o.observable(t(s.reboot_min1)),n.monthHour=o.observable(t(s.reboot_hour2)),n.monthMinutes=o.observable(t(s.reboot_min2)),n.intervalHour_week=o.observable(t(s.reboot_threshold_hours1)),n.intervalHour_day=o.observable(t(s.reboot_threshold_hours2)),n.intervalDay=o.observable(i);var l;s.reboot_dod;0==s.reboot_dow?e("td:eq(6)","#weekTable").addClass("wmSelected"):(l=s.reboot_dow-1,e("td:eq("+l+")","#weekTable").addClass("wmSelected")),n.currentIntervals=o.observable(s.reboot_dod),n.updateCurrentTime=function(){var e=globalTime.getFullYear()+"/"+getTwoDigit(globalTime.getMonth()+1)+"/"+getTwoDigit(globalTime.getDate())+" "+getTwoDigit(globalTime.getHours())+":"+getTwoDigit(globalTime.getMinutes())+":"+getTwoDigit(globalTime.getSeconds());n.currentTime(e),globalTime.setTime(globalTime.getTime()+1e3)},n.setAllowedReboot=function(){if(!e("#rebootBtn").hasClass("disable")){var o=e("#isAllowedReboot:checked");o&&0==o.length?(n.isAllowedReboot("1"),n.enableReboot(!0)):(n.isAllowedReboot("0"),n.enableReboot(!1))}},n.setRebootByWeek=function(){if(!e("#reboot_by_week").hasClass("disable")){var o=e("#rebootByWeek:checked");o&&0==o.length&&(n.isRebootMode("1"),e("#weekTimeHour").addClass("required"),e("#weekTimeMinutes").addClass("required"),e("#monthTimeHour").removeClass("required"),e("#monthTimeMinutes").removeClass("required"))}},n.setRebootByMonth=function(){if(!e("#reboot_by_month").hasClass("disable")){var o=e("#rebootByMonth:checked");o&&0==o.length&&(n.isRebootMode("2"),e("#weekTimeHour").removeClass("required"),e("#weekTimeMinutes").removeClass("required"),e("#monthTimeHour").addClass("required"),e("#monthTimeMinutes").addClass("required"))}},n.apply=function(){if(!r.getSysTimeMode())return showAlert("system_time_not_syn"),!1;showLoading("operating");var o={};o.goformId="FIX_TIME_REBOOT_SCHEDULE",o.reboot_schedule_enable=n.isAllowedReboot(),o.reboot_schedule_mode=n.isRebootMode(),o.reboot_hour1=n.weekHour(),o.reboot_min1=n.weekMinutes(),o.reboot_hour2=n.monthHour(),o.reboot_min2=n.monthMinutes(),o.reboot_timeframe_hours1=n.intervalHour_week(),o.reboot_timeframe_hours2=n.intervalHour_day(),o.reboot_dow=e("td.wmSelected","#weekTable").data("val"),o.reboot_dod=n.currentIntervals(),r.setRebootScheduleFixTime(o,function(e){"success"==e.result?successOverlay():errorOverlay()})}}function a(){var t=e("#container");o.cleanNode(t[0]);var r=new n;o.applyBindings(r,t[0]),r.updateCurrentTime(),addInterval(function(){r.updateCurrentTime()},1e3),e("#enableRebootFrm").validate({submitHandler:function(){r.apply()},rules:{weekTimeHour:{any_digits:!0,range:[0,23]},weekTimeMinutes:{any_digits:!0,range:[0,59]},monthTimeHour:{any_digits:!0,range:[0,23]},monthTimeMinutes:{any_digits:!0,range:[0,59]},intervalHourWeek:{any_digits:!0,range:[1,6]},intervalHourDay:{any_digits:!0,range:[1,6]}},groups:{weekTime:"weekTimeHour weekTimeMinutes",monthTime:"monthTimeHour monthTimeMinutes"},errorPlacement:function(e,o){"weekTimeHour"==o.attr("name")||"weekTimeMinutes"==o.attr("name")?e.insertAfter("#weekTimeError"):"monthTimeHour"==o.attr("name")||"monthTimeMinutes"==o.attr("name")?e.insertAfter("#intervalTimeError"):"intervalHourWeek"==o.attr("name")?e.insertAfter("#weekIntervalError"):"intervalHourDay"==o.attr("name")?e.insertAfter("#dayIntervalError"):e.insertAfter(o)}}),e("td","#weekTable").click(function(){e("td","#weekTable").removeClass("wmSelected"),e(this).addClass("wmSelected")})}var i=[];return function(e,o,t){for(var r={},n=e;n<=o;n++)r.name=n,r.value=n,t.push(new Option(r.name,r.value))}(1,30,i),{init:a}});
//# sourceMappingURL=../../sourcemaps/adm/restart_schedule.js.map
