define(["jquery","knockout","config/config","service","underscore"],function(e,i,t,a,s){function o(){var t=this,o=a.getParams({nv:"wifi_onoff_wifi5g_by_n79_mutex"}).wifi_onoff_wifi5g_by_n79_mutex;t.wifi5GIsOn=i.observable("1"!=o);var n=c();l();t.show24MainWifi=i.observable("1"==n.AccessPointSwitchStatus_1_1),t.show5MainWifi=i.observable("1"==n.AccessPointSwitchStatus_2_1),t.diagnosisResult=i.observable(""),t.simCardStatus=i.observable(""),t.simCardError=i.observable(""),t.wifiSwitch=i.observable(""),t.mainWifi24Switch=i.observable(""),t.guestWifi24Switch=i.observable(""),t.mainWifi24AuthMode=i.observable(""),t.guestWifi24AuthMode=i.observable(""),t.mainWifi5Switch=i.observable(""),t.guestWifi5Switch=i.observable(""),t.mainWifi5AuthMode=i.observable(""),t.guestWifi5AuthMode=i.observable(""),t.MainWifi24ShowSsid=i.observable(""),t.GuestWifi24ShowSsid=i.observable(""),t.MainWifi5ShowSsid=i.observable(""),t.GuestWifi5ShowSsid=i.observable(""),t.wifiDriverNormal=i.observable(""),t.wifiAccessNum=i.observable(""),t.wifiCoverage=i.observable(""),t.wifiCoverageVal=i.observable(""),t.currentApn=i.observable(""),t.currData=i.observable(""),t.currWifiAccess=i.observable(""),t.network_register_result=i.observable(""),t.connectFailCount=i.observable(""),t.currWorkMode=i.observable(""),t.blackDevices=i.observableArray([]),t.showBlackList=i.observable(""),t.whiteDevices=i.observableArray([]),t.showWhiteList=i.observable(""),t.clickDiag=i.observable(!1),t.remoteMan=i.observable(""),t.pingWan=i.observable(""),t.portFilter=i.observable(""),t.portForwarding=i.observable(""),t.guestRouterOpen=i.observable(""),t.antiVioCra=i.observable(""),t.dhcpServer=i.observable(""),t.dnsData=i.observable(""),t.wifiAwakeSwitch=i.observable(""),t.upnpSwitch=i.observable(""),t.showApIsolation=i.observable(""),t.showApIsolation24=i.observable(""),t.showApIsolation5=i.observable(""),t.showApIsolationG24=i.observable(""),t.showApIsolationG5=i.observable(""),t.ACLMode=i.observable("");var d={aclMode:2,user_ip:"",macList:"",hostnameList:""},u=a.getHostNameList({}).devices,b={dealElement:function(i,t){i?(e("#edit_btn_"+t+",#hostname_txt_"+t).hide(),e("#save_btn_"+t+",#cancel_btn_"+t+",#hostname_input_"+t).show()):(e("#edit_btn_"+t+",#hostname_txt_"+t).show(),e("#save_btn_"+t+",#cancel_btn_"+t+",#hostname_input_"+t).hide())},parseBlackString:function(e,i){if(""==e)return[];for(var t=i.split(";"),a=e.split(";"),s=[],o=0;o<a.length-1;o++){var r={};r.hostName=t[o],r.macAddress=a[o],s.push({hostName:t[o],macAddress:a[o]})}return s},getHostName:function(e,i,t){var a=s.find(t,function(e){return e.mac==i});return a?a.hostname:e}};t.fetchBlacklist=function(i){a.getDeviceAccessControlList({},function(e){d.aclMode=e.aclMode,d.macList=e.wifiMacBlackList,d.hostnameList=e.wifiHostnameBlackList;var a=b.parseBlackString(e.wifiMacBlackList,e.wifiHostnameBlackList);t.blackDevices(s.map(a,function(e,i){return e.idx=s.uniqueId("black_"),e.hostName=b.getHostName(e.hostName,e.macAddress,u),e.type=3,e})),s.isFunction(i)&&i.apply(this)},e.noop)},t.fetchWhitelist=function(i){a.getDeviceAccessControlList({},function(e){d.aclMode=e.aclMode,d.macList=e.wifiMacWhiteList,d.hostnameList=e.wifiHostnameWhiteList;var a=b.parseBlackString(e.wifiMacWhiteList,e.wifiHostnameWhiteList);t.whiteDevices(s.map(a,function(e,i){return e.idx=s.uniqueId("white_"),e.hostName=b.getHostName(e.hostName,e.macAddress,u),e.type=3,e})),s.isFunction(i)&&i.apply(this)},e.noop)},t.diagnosis=function(){showLoading("diagnosising"),a.diagnosisSettings({},function(i){var s=c(),o=l(),n=a.getStatusInfo();t.simCardStatus("modem_init_complete"==i.simCardStatus?1:0),0==t.simCardStatus()&&("modem_sim_undetected"==i.simCardStatus?t.simCardError("diag_sim_no_sim"):"modem_waitpin"==i.simCardStatus?t.simCardError("diag_sim_pin"):"modem_waitpuk"!=i.simCardStatus&&0!=i.pinnumber||0==i.puknumber?"modem_imsi_waitnck"==i.simCardStatus?t.simCardError("diag_sim_wrong_sim"):0!=i.puknumber&&"modem_sim_destroy"!=i.simCardStatus||"modem_sim_undetected"==i.simCardStatus||"modem_undetected"==i.simCardStatus?t.simCardError("diag_sim_no_sim"):t.simCardError("diag_sim_puk_lock"):t.simCardError("diag_sim_puk")),r(t.simCardError(),"sim_card_error_alert"),t.wifiDriverNormal("1"==i.wifiDriverNormal?0:1),t.network_register_result("limited_service"!=i.networkType&&"no_service"!=i.networkType&&""!=i.networkType?1:0),t.connectFailCount(0==t.simCardStatus()?0:i.connectFailCount>=1?0:1),t.dhcpServer("1"==i.dhcpEnabled?1:0),checkConnectedStatus(n.connectStatus)?t.dnsData(i.dnsDataIsError?0:1):t.dnsData(0),t.wifiAwakeSwitch(1==i.wifiAwakeSwitch?1:0),t.upnpSwitch(1==i.upnpSwitch?0:1),t.remoteMan("1"==i.remoteFlag?0:1),t.pingWan("1"==i.pingFlag?0:1),t.portFilter("1"==i.portFilterEnable&&"1"==i.defaultPolicy?1:0),t.portForwarding("1"==i.PortForwardEnable?1:0),t.antiVioCra("1"==i.antiVioCraEnable?0:1),t.guestRouterOpen("1"==i.guestRouterEnable?1:0),t.mainWifi24Switch("1"==s.AccessPointSwitchStatus_1_1),t.mainWifi24AuthMode("OPEN"==s.AuthMode?1:0),t.mainWifi5Switch("1"==s.AccessPointSwitchStatus_2_1),t.mainWifi5AuthMode("OPEN"==o.AuthMode?1:0),t.wifiSwitch("1"==s.wifiSwitch),t.wifiAccessNum(a.getStatusInfo().attachedDevices),t.MainWifi24ShowSsid("0"==s.ApBroadcastDisabled?"1":"0"),t.MainWifi5ShowSsid("0"==o.ApBroadcastDisabled?"1":"0"),t.wifiCoverage("short_mode"==i.wifi_coverage?0:1),t.wifiCoverageVal(i.wifi_coverage),r("wifi_"+i.wifi_coverage,"wifi_range_val"),t.showApIsolation24(1==s.ApIsolate),t.showApIsolation5(1==o.ApIsolate),t.showApIsolation(t.showApIsolation24()||t.showApIsolation5()),t.currentApn(i.wanAPN),t.currData(transUnit(parseInt(i.monthlySent,10)+parseInt(i.monthlyReceived,10),!1)),t.currWifiAccess(a.getStatusInfo().attachedDevices);var d="DHCP"==i.currMode||"STATIC"==i.currMode?"PPPOE":i.currMode,u="";switch(d){case"LTE_BRIDGE":u="opmode_bridge";break;case"PPPOE":u="opmode_cable";break;case"PPP":u="opmode_gateway";break;case"AUTO":u="opmode_auto"}t.currWorkMode(e.i18n.prop(u)),r(u,"curr_work_mode_val"),t.showBlackList(2==a.getDeviceAccessControlList().aclMode),t.showWhiteList(1==a.getDeviceAccessControlList().aclMode),t.fetchBlacklist(),t.fetchWhitelist(),t.clickDiag(!0),e("#dialog_div").translate(),addTimeout(function(){hideLoading()},1e3)},e.noop)}}function r(i,t){e("#"+t).attr("data-trans",i)}function n(){e("#arrow_black.smartListDisplay").die().live("click",function(){var i=e(this);e("#black_div").slideToggle(),i.toggleClass("downArrowClose")}),e("#arrow_white.smartListDisplay").die().live("click",function(){var i=e(this);e("#white_div").slideToggle(),i.toggleClass("downArrowClose")})}function c(){var e=a.getWifiModuleSwitchStatus(),i=a.getWifiAccessPointInfo();return wifiFilterAPInfo(e,i,t.WIFICHIPINDEX.FIRST,t.ACCESSPOINTINDEX.FIRST,t.WIFICHIPINDEX,t.ACCESSPOINTINDEX)}function l(){var e=a.getWifiModuleSwitchStatus(),i=a.getWifiAccessPointInfo();return wifiFilterAPInfo(e,i,t.WIFICHIPINDEX.SECOND,t.ACCESSPOINTINDEX.FIRST,t.WIFICHIPINDEX,t.ACCESSPOINTINDEX)}function d(){var t=new o;i.applyBindings(t,e("#container")[0]),n(),e("#frmDiagnosis").validate({submitHandler:function(){t.diagnosis()}})}return{init:d}});
//# sourceMappingURL=../../sourcemaps/adm/diagnosis.js.map
