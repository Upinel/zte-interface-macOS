define(["jquery","knockout","config/config","service"],function(n,e,t,i){function a(){var a=this,u=i.getPinData();a.isDataCard=-1!=t.DEVICE.toLowerCase().indexOf("datacard"),a.originPinStatus=e.observable(u.pin_status),a.pinStatus=e.observable(u.pin_status),a.pinNumber=e.observable(u.pinnumber),a.pukNumber=e.observable(u.puknumber),a.currentPin=e.observable(),a.newPin=e.observable(),a.confirmPin=e.observable(),a.puk=e.observable(),a.pageState=e.observable(),a.optSuccess=!0,a.changePin=function(){if(a.isConnectedNetWork())return void showAlert("cannot_operate_when_connected");if(a.pageState()!=c.common){var n={oldPin:a.currentPin(),newPin:a.newPin()};showLoading(),a.pageState()==c.modifyPin?i.changePin(n,a.callback):a.pageState()==c.requirePuk?(n={PinNumber:a.newPin(),PUKNumber:a.puk()},i.enterPUK(n,a.callback)):a.pinStatus()==r.enable?i.enablePin(n,a.callback):i.disablePin(n,a.callback)}},a.callback=function(n){n&&1==n.result?(a.optSuccess=!0,successOverlay()):(a.optSuccess=!1,errorOverlay()),o(a)},a.displayModifyPinPage=function(){if(a.isConnectedNetWork())return void showAlert("cannot_operate_when_connected");a.pinStatus(a.originPinStatus()),a.pageState(c.modifyPin),a.clear()},a.cancel=function(){a.pageState(c.common),a.pinStatus(a.originPinStatus()),a.clear()},a.clear=function(){a.currentPin(""),a.newPin(""),a.confirmPin(""),a.puk(""),clearValidateMsg()},a.pinStatusChangeEvent=e.dependentObservable(function(){a.pinStatus()==a.originPinStatus()?a.pageState(c.common):a.pageState(c.requirePin),a.clear()},this),a.computePageState=function(n){n.pinnumber>0?a.optSuccess?a.cancel():a.clear():(a.clear(),n.puknumber>0?a.pageState(c.requirePuk):a.pageState(c.destroyed))},a.computePageState(u),a.isConnectedNetWork=function(){var n=i.getConnectionInfo();return checkConnectedStatus(n.connectStatus)},a.isConnectingOrDisconnectingNetWork=function(){var n=i.getConnectionInfo();return checkConnectingOrDisconnectingStatus(n.connectStatus)},a.fixPageEnable=function(){a.isConnectedNetWork()||a.isConnectingOrDisconnectingNetWork()?(n("#frmPin :input").each(function(){disableBtn(n(this))}),clearValidateMsg()):n("#frmPin :input").each(function(){return"txtPin"!=this.id&&"btnPinApply"!=this.id||a.pageState()!=c.common?"btnModifyPin"==this.id&&a.originPinStatus()!=r.enable?void disableBtn(n(this)):"pinEnable"!=this.id&&"pinDisable"!=this.id||a.pageState()!=c.modifyPin?void enableBtn(n(this)):void disableBtn(n(this)):void disableBtn(n(this))})}}function o(t){var o=t;if(o){var c=i.getPinData();o.originPinStatus(c.pin_status),o.pinNumber(c.pinnumber),o.pukNumber(c.puknumber),o.computePageState(c)}else o=new a,addInterval(function(){o.fixPageEnable()},1e3);e.applyBindings(o,n("#container")[0]),o.fixPageEnable(),n("#frmPin").validate({submitHandler:function(){o.changePin()},rules:{txtPuk:"puk_check",txtPin:"pin_check",txtNewPin:"pin_check",txtConfirmPin:{equalToPin:"#txtNewPin"}}})}var c={common:0,requirePin:1,modifyPin:2,requirePuk:3,destroyed:4},r={enable:"1",disable:"0"};return{init:o}});
//# sourceMappingURL=../../sourcemaps/adm/pin.js.map
